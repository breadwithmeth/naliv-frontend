# ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ API —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –≤ Checkout

## üöÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ Checkout.tsx

### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

#### 1. **–î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤—ã–π endpoint: `POST /api/orders/create-user-order`
- –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑ –±–µ–∑ –æ–ø–ª–∞—Ç—ã
- –ó–∞—Ç–µ–º –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ `POST /api/orders/{orderId}/pay`

#### 2. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–º—É API
- –ü–æ–ª–µ `delivery` –≤–º–µ—Å—Ç–æ `delivery_type`
- –ü–æ–ª–µ `bonus` –∫–∞–∫ boolean
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–ø—Ü–∏–π —Ç–æ–≤–∞—Ä–æ–≤

#### 3. **–£–ª—É—á—à–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–æ—Ü–µ—Å—Å–∞**
- –†–∞–∑–¥–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ –∏ –æ–ø–ª–∞—Ç—ã
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –õ—É—á—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:
```typescript
const handlePlaceOrder = async () => {
  // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–º—É API
  const orderData = {
    business_id: selectedBusiness.id,
    items: cartItems.map(item => ({
      item_id: item.item_id,
      amount: item.cartQuantity,
      options: item.selectedOptions?.map(option => ({
        option_item_relation_id: option.variant.relation_id,
        price: option.variant.price,
        parent_amount: option.variant.parent_item_amount || 1
      })) || []
    })),
    delivery: selectedDeliveryMethod === 'delivery',
    bonus: false,
    extra: comment || undefined,
    card_id: selectedCard.card_id
  }

  // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –±–µ–∑ –æ–ø–ª–∞—Ç—ã
  const response = await fetch('/api/orders/create-user-order', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${localStorage.getItem('token')}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(orderData)
  })

  // –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
  const paymentSuccess = await initiateOrderPayment(result.data.order_id)
}
```

### –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã:
```typescript
const initiateOrderPayment = async (orderId: number): Promise<boolean> => {
  const response = await fetch(`/api/orders/${orderId}/pay`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${localStorage.getItem('token')}`,
      'Content-Type': 'application/json'
    }
  })
  
  // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
  return await monitorPaymentStatus(orderId)
}
```

---

## üé® UI –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 1. **–ö–Ω–æ–ø–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞**
```tsx
{isProcessing ? (
  <div className="flex items-center justify-center space-x-2">
    <div className="animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"></div>
    <span>–°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑ –∏ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ–º –æ–ø–ª–∞—Ç—É...</span>
  </div>
) : (
  `–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∏ –æ–ø–ª–∞—Ç–∏—Ç—å ${total.toFixed(2)} ‚Ç∏`
)}
```

### 2. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**
```tsx
<h4 className="font-medium text-green-800 mb-1">
  –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞
</h4>
<p className="text-sm text-green-700 mb-2">
  –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑, –∑–∞—Ç–µ–º –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞ —Å –∫–∞—Ä—Ç—ã {selectedCard.mask}
</p>
<div className="flex items-center text-xs text-green-600">
  <span className="mr-1">‚úì</span>
  <span>–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</span>
  <span className="mx-2">‚Üí</span>
  <span className="mr-1">‚úì</span>
  <span>–ò–Ω–∏—Ü–∏–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã</span>
  <span className="mx-2">‚Üí</span>
  <span className="mr-1">‚úì</span>
  <span>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</span>
</div>
```

---

## üîÑ –ù–æ–≤—ã–π –ø–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:
1. **–í—ã–±–æ—Ä —Ç–æ–≤–∞—Ä–æ–≤** ‚Üí –ö–æ—Ä–∑–∏–Ω–∞
2. **–í—ã–±–æ—Ä –∫–∞—Ä—Ç—ã** ‚Üí –ò–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—Ñ–∏–ª–µ  
3. **–ù–∞–∂–∞—Ç–∏–µ "–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∏ –æ–ø–ª–∞—Ç–∏—Ç—å"** ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã** ‚Üí –ó–∞–ø—Ä–æ—Å –Ω–∞ –æ–ø–ª–∞—Ç—É
5. **–û–∂–∏–¥–∞–Ω–∏–µ** ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç** ‚Üí –£—Å–ø–µ—Ö –∏–ª–∏ –æ—à–∏–±–∫–∞

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- ‚úÖ **–£—Å–ø–µ—Ö**: –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω –∏ –æ–ø–ª–∞—á–µ–Ω ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ø–µ—Ö–∞
- ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω—ã–π —É—Å–ø–µ—Ö**: –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω, –Ω–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–º –∑–∞–∫–∞–∑–∞–º
- ‚ùå **–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: –ó–∞–∫–∞–∑ –Ω–µ —Å–æ–∑–¥–∞–Ω ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

---

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è API

### –°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ):
```json
{
  "business_id": 1,
  "address_id": 15,
  "delivery_type": "DELIVERY",
  "saved_card_id": 7
}
```

### –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (–¥–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π):
```json
{
  "business_id": 1,
  "delivery": true,
  "bonus": false,
  "card_id": 7
}
```

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- üîç **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ –∏ –æ–ø–ª–∞—Ç—ã
- ÔøΩÔ∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞
- üì± **–ì–∏–±–∫–æ—Å—Ç—å**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
- üîß **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ–ø–ª–∞—Ç—ã
- üìä **–ö–æ–Ω—Ç—Ä–æ–ª—å**: –õ—É—á—à–µ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ÔøΩ **–û—Ç–ª–∞–¥–∫–∞**: –ü—Ä–æ—â–µ –Ω–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —ç—Ç–∞–ø–µ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–ø–ª–∞—Ç–∞**
   - –í—ã–±—Ä–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –∏ –∫–∞—Ä—Ç—É
   - –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ ‚Üí –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å

2. **–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω, –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞**
   - –ö–∞—Ä—Ç–∞ —Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏
   - –ó–∞–∫–∞–∑ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–º

3. **–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞**
   - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –ó–∞–∫–∞–∑ –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è

4. **–¢–∞–π–º–∞—É—Ç –æ–ø–ª–∞—Ç—ã**
   - –î–æ–ª–≥–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º API —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å: —Å–æ–∑–¥–∞–Ω–∏–µ ‚Üí –æ–ø–ª–∞—Ç–∞
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø—Ü–∏–π —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–µ UI –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–∞
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è TypeScript
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ Responsive –¥–∏–∑–∞–π–Ω

**–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É! üöÄ**
